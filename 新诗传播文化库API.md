# 新诗传播文化库API

---
## 注意
1. 因为没有写好代码,所以接口以后可能会有变动,请慎重
2. 接口返回的数据格式统一为
```
{
    code:xxx,
    msg:"报错信息(**基本**可以直接拿来显示)|成功信息",
    [data:"数据,非查询接口可能没有该字段"]
}
```
成功状态码为000,失败状态码为999
代码完成后会贴出详细状态码表
3. 接口返回值暂只列出数据,以后会列出可能返回的状态码
4. 接口会使用jwt做鉴权,token是用户身份的凭证,后端会根据token验证用户的身份,再判断是否有权限调用接口,所以每次请求要在请求头携带token;token会在登陆的接口返回(以后会给获取测试token的接口)

---
* [1.文献库管理](#1)

* [2.文献管理](#2)

* [n.数据契约](#n)

---
## <span id="1">1.文献库管理</span>

---
## 获取库数据
接口说明:
获取库的所有内容,包括子库和文献

请求地址:
/repo/{库的id}

请求方式:
GET

请求参数:
url路径,值为文献库的id

接口返回值:
```
{
    "subRepos":[],
    "docs":[],
}
```
---
## 新建库
接口说明:
新建子库

请求地址:
/repo/{父库的id}

请求方式:
PUT

请求参数:
1. url路径,值想要创建的文献库的**父库的id**
2. 库的相关信息:
```
{
    repoName:"库名"
    description:"库的描述",
    types:[],
    creator:{
        userId:"用户的id(不知道有没有用)",
        name:"用户名",
        time:"操作的时间",
    },
}
```

接口返回值:

---
## 获取库结构
接口说明:
获取库的结构

请求地址:
/repos

请求方式:
GET

请求参数:
无

接口返回值:
```
[{
  "id": 1,
  "repoName": "诗作库",
  "types": [],
  "state": "using",
  "subDeps": [
    {
      "id": 2,
      "name": "单篇库",
      "types": [],
      "state": "using",
      "subDeps": [],
    }
  ]
}
```
---
## 修改库
接口说明:
修改库的信息,封锁,解锁库,删除库也使用以下接口

请求地址:
/repo/{库的id}

请求方式:
POST

请求参数:
1. url路径,值为文献库的id
2. 修改的值,只能修改以下数据,可以只传需要修改的值,删除,封锁,解锁,只需要修改state字段即可
```
{
    repoName:"库名"
    description:"库的描述",
    types:[],
    "state": "using",
}
```
接口返回值:
```
{
    "subRepos":[],
    "docs":[],
}
```

---
## 迁移库
接口说明:
迁移库到另一个库下

请求地址:
/repo/movement

请求方式:
POST

请求参数:
{
    id:"要操作的库的id",
    targetRepo:"目标库,库会迁移到此库下"
}

接口返回值:
暂无

---
## 备份库
接口说明:
备份库

请求地址:
/repo/backup/{库的id}

请求方式:
GET

请求参数:
url路径参数,库的id

接口返回值:
暂时没想好

---






<span id="n">n.数据契约</span>
```



```




